$.fn.postLike=function(){if($(this).hasClass("done")){return false}else{$(this).addClass("done");var d=$(this).data("id"),c=$(this).data("action"),b=$(this).children(".love-count");var a={action:"lo_like",um_id:d,um_action:c};$.post(ajax.ajax_url,a,function(e){$(b).html(e)});return false}};$(document).on("click",".favorite",function(){$(this).postLike()});$.fn.typing=function(g){var b={speed:100,range:0,repeat:true,flashback:true,flicker:false};$.extend(b,g);var f=$(this);var e=$(this).text().split("");var a=0;var c=1;$(e).each(function(j,h){e[j]=(e[j-1]?e[j-1]:"")+e[j]});f.css("border-right","1px solid #000");setTimeout(d,b.speed);function d(){f.text(e[a]);if(a>=(e.length-1)&&b.repeat){if(b.flashback){c=-1}else{a=0}if(b.flicker){f.delay(200).fadeOut(1).delay(400).fadeIn(1).delay(200).fadeOut(1).delay(400).fadeIn(1)}setTimeout(d,2000)}else{if(a>=(e.length-1)&&!b.repeat){if(b.flicker){f.delay(200).fadeOut(1).delay(400).fadeIn(1).delay(200).fadeOut(1).delay(400).fadeIn(1)}f.css("border-right","")}else{if(a<0){a=0;c=1;setTimeout(d,Math.random()*b.range+b.speed)}else{setTimeout(d,Math.random()*b.range+b.speed)}}}a+=c}};$(document).ready(function(e){var j=e("#commentform"),d='<div id="loading"><img src="/wp-includes/images/spinner.gif">正在提交, 请稍候...</div>',b='<div id="error">#</div>',a='">提交成功',t=', 刷新页面之前可以<a rel="nofollow" class="comment-reply-link" href="#edit" onclick=\'return addComment.moveForm("',r=")'>再编辑</a>",c="取消编辑",l,h=1,m=e("#comments-title span"),g=e("#cancel-comment-reply-link"),u=g.text(),q=e("#commentform #submit");q.attr("disabled",false),$body=(window.opera)?(document.compatMode=="CSS1Compat"?e("html"):e("body")):e("html,body"),comm_array=[];comm_array.push("");e("#comment").after(d+b);e("#loading").hide();e("#error").hide();e(document).on("submit","#commentform",function(){if(l){e("#comment").after('<input type="text" name="edit_id" id="edit_id" value="'+l+'" style="display:none;" />')}i();q.attr("disabled",true).fadeTo("slow",0.5);e("#loading").slideDown();e.ajax({url:ajax.ajax_url,data:e(this).serialize()+"&action=ajax_comment",type:e(this).attr("method"),error:function(v){e("#loading").hide();e("#error").slideDown().html(v.responseText);setTimeout(function(){q.attr("disabled",false).fadeTo("slow",1);e("#error").slideUp()},3000)},success:function(A){e("#loading").hide();comm_array.push(e("#comment").val());e("textarea").each(function(){this.value=""});var x=addComment,z=x.I("cancel-comment-reply-link"),v=x.I("wp-temp-form-div"),B=x.I(x.respondId),w=x.I("comment_post_ID").value,y=x.I("comment_parent").value;if(!l&&m.length){n=parseInt(m.text().match(/\d+/));m.text(m.text().replace(n,n+1))}new_htm='" id="new_comm_'+h+'"></';new_htm=(y=="0")?('\n<ol style="clear:both;" class="commentlist'+new_htm+"ol>"):('\n<ul class="children'+new_htm+"ul>");ok_htm='\n<div class="ajax-notice" id="success_'+h+a;div_=(document.body.innerHTML.indexOf("div-comment-")==-1)?"":((document.body.innerHTML.indexOf("li-comment-")==-1)?"div-":"");ok_htm=ok_htm.concat(t,div_,"comment-",y,'", "',y,'", "respond", "',w,'", ',h,r);ok_htm+="</span><span></span>\n";ok_htm+="</div>\n";e("#respond").before(new_htm);e("#new_comm_"+h).append(A);e("#new_comm_"+h+" li").append(ok_htm);$body.animate({scrollTop:e("#new_comm_"+h).offset().top-200},900);k();h++;l="";e("*").remove("#edit_id");z.style.display="none";z.onclick=null;x.I("comment_parent").value="0";if(v&&B){v.parentNode.insertBefore(B,v);v.parentNode.removeChild(v)}}});return false});addComment={moveForm:function(y,z,D,x,A){var H=this,v,C=H.I(y),w=H.I(D),G=H.I("cancel-comment-reply-link"),E=H.I("comment_parent"),F=H.I("comment_post_ID");if(l){o()}A?(H.I("comment").value=comm_array[A],l=H.I("new_comm_"+A).innerHTML.match(/(comment-)(\d+)/)[2],$new_sucs=e("#success_"+A),$new_sucs.hide(),$new_comm=e("#new_comm_"+A),$new_comm.hide(),g.text(c)):g.text(u);H.respondId=D;x=x||false;if(!H.I("wp-temp-form-div")){v=document.createElement("div");v.id="wp-temp-form-div";v.style.display="none";w.parentNode.insertBefore(v,w)}!C?(temp=H.I("wp-temp-form-div"),H.I("comment_parent").value="0",temp.parentNode.insertBefore(w,temp),temp.parentNode.removeChild(temp)):C.parentNode.insertBefore(w,C.nextSibling);$body.animate({scrollTop:e("#respond").offset().top-180},400);if(F&&x){F.value=x}E.value=z;G.style.display="";G.onclick=function(){if(l){o()}var J=addComment,I=J.I("wp-temp-form-div"),K=J.I(J.respondId);J.I("comment_parent").value="0";if(I&&K){I.parentNode.insertBefore(K,I);I.parentNode.removeChild(I)}this.style.display="none";this.onclick=null;return false};try{H.I("comment").focus()}catch(B){}return false},I:function(v){return document.getElementById(v)}};function o(){$new_comm.show();$new_sucs.show();e("textarea").each(function(){this.value=""});l=""}var p=15,f=q.val();function k(){if(p>0){q.val(p);p--;setTimeout(k,1000)}else{q.val(f).attr("disabled",false).fadeTo("slow",1);p=15}}function i(){var x="",v=e("#comment").val(),y=v.indexOf("<code>"),w=v.indexOf("</code>");if(y>-1&&w>-1&&y<w){x="";while(w!=-1){x+=v.substring(0,y+6)+v.substring(y+6,w).replace(/<(?=[^>]*?>)/gi,"&lt;").replace(/>/gi,"&gt;");v=v.substring(w+7,v.length);y=v.indexOf("<code>")==-1?-6:v.indexOf("<code>");w=v.indexOf("</code>");if(w==-1){x+="</code>"+v;e("#comment").val(x)}else{if(y==-6){myFielde+="&lt;/code&gt;"}else{x+="</code>"}}}}var v=x?x:e("#comment").val(),x="",y=v.indexOf("<pre>"),w=v.indexOf("</pre>");if(y>-1&&w>-1&&y<w){x=x}else{return}while(w!=-1){x+=v.substring(0,y+5)+v.substring(y+5,w).replace(/<(?=[^>]*?>)/gi,"&lt;").replace(/>/gi,"&gt;");v=v.substring(w+6,v.length);y=v.indexOf("<pre>")==-1?-5:v.indexOf("<pre>");w=v.indexOf("</pre>");if(w==-1){x+="</pre>"+v;e("#comment").val(x)}else{if(y==-5){myFielde+="&lt;/pre&gt;"}else{x+="</pre>"}}}}function s(w){var v;w=" "+w+" ";if(document.getElementById("comment")&&document.getElementById("comment").type=="textarea"){v=document.getElementById("comment")}else{return false}if(document.selection){v.focus();sel=document.selection.createRange();sel.text=w;v.focus()}else{if(v.selectionStart||v.selectionStart=="0"){var z=v.selectionStart;var y=v.selectionEnd;var x=y;v.value=v.value.substring(0,z)+w+v.value.substring(y,v.value.length);x+=w.length;v.focus();v.selectionStart=x;v.selectionEnd=x}else{v.value+=w;v.focus()}}}});$(document).on("click",".commentnav a",function(){var c=$(this).attr("href"),e=$(".commentshow"),f=$(this).parent().data("postid"),d=1,b=$("#cancel-comment-reply-link");/comment-page-/i.test(c)?d=c.split(/comment-page-/i)[1].split(/(\/|#|&).*$/)[0]:/cpage=/i.test(c)&&(d=c.split(/cpage=/)[1].split(/(\/|#|&).*$/)[0]);b.click();d=d.split("#")[0];var a={action:"ajax_comment_page_nav",um_post:f,um_page:d};e.html("<div>loading..</div>");$("body, html").animate({scrollTop:e.offset().top-150},1000);$.post(ajax.ajax_url,a,function(g){e.html(g);$("body, html").animate({scrollTop:e.offset().top-50},1000)});return false});$(document).on("click",".post-share>a",function(a){a.preventDefault();if($(this).parent().hasClass("share-on")){$(this).parent().removeClass("share-on");$(this).next().hide()}else{$(this).parent().addClass("share-on");$(this).next().show()}return false});$(document).on("click",".post-share ul li a",function(a){$(this).parent().parent().parent().removeClass("share-on");$(this).parent().parent().hide()});$(document).on("click",".open-nav",function(){if($("body").hasClass("has-opened")){$("body").removeClass("has-opened");$("#mobile-nav").delay(500).hide(100)}else{$("#mobile-nav").show();$("body").addClass("has-opened")}});$(document).on("touchstart",".has-opened #wrap",function(){$("body").removeClass("has-opened");$("#mobile-nav").delay(500).hide(100)});function initgallary(){$(".flexslider").flexslider({animation:"slide",controlNav:"thumbnails",smoothHeight:true,touch:true})}function lazyloadinit(){$("img").lazyload({threshold:200,effect:"fadeIn"})}$(document).ready(function(b){var a=b("#sidebar .widget"),c=a.length;if(0<asr_1<=c&&0<asr_2<=c){b(window).scroll(function(){var d=document.documentElement.scrollTop+document.body.scrollTop;if(d>a.eq(c-1).offset().top+a.eq(c-1).height()){if(b(".widgetRoller").length==0){a.parent().append('<aside class="widgetRoller"></aside>');a.eq(asr_1-1).clone().appendTo(".widgetRoller");if(asr_1!==asr_2){a.eq(asr_2-1).clone().appendTo(".widgetRoller")}b(".widgetRoller").css({position:"fixed",top:10})}else{b(".widgetRoller").fadeIn(300)}}else{b(".widgetRoller").hide()}})}b(".archives ul.archives-monthlisting").hide();b(".archives ul.archives-monthlisting:first").show();b(".archives .m-title").click(function(){b(this).next().slideToggle("fast");return false});b("#header .desc span").typing({range:100,repeat:false});initgallary();lazyloadinit();b("#qr").hover(function(){b("#qrimg").show(300)},function(){b("#qrimg").hide(300)});b(window).scroll(function(){b(this).scrollTop()>100?b("#gotop").css({bottom:"110px"}):b("#gotop").css({bottom:"-110px"})});b("#gotop").click(function(){return b("body,html").animate({scrollTop:0},800),!1});b(".openpre").click(function(){if(b(this).hasClass("close")){b(this).removeClass("close");b(this).addClass("open");b("#preheader").slideDown(400)}else{b(this).removeClass("open");b(this).addClass("close");b("#preheader").slideUp(400)}return false})});
